<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"m1nilong.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.21.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="网络流，网络建模最毒瘤。 本篇学习笔记为本人学习网络流建模的一些基本模型，也作为当前常见网络流建模的一个汇总。 只写了一点，可能有时间再补。  $last \space updated:2023.3.31$ 有些建模的题只写上来了几道，还会继续更，很多模型还没写上去。qwq  最大流朴素建模 P3376 【模板】网络最大流  模板题，按照题目输入连边跑最大流即可。  P2936 [USACO09J">
<meta property="og:type" content="article">
<meta property="og:title" content="minilong&#39;s blog">
<meta property="og:url" content="http://m1nilong.github.io/2024/09/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%B5%85%E8%B0%88%E7%BD%91%E7%BB%9C%E6%B5%81%E5%BB%BA%E6%A8%A1/index.html">
<meta property="og:site_name" content="minilong&#39;s blog">
<meta property="og:description" content="网络流，网络建模最毒瘤。 本篇学习笔记为本人学习网络流建模的一些基本模型，也作为当前常见网络流建模的一个汇总。 只写了一点，可能有时间再补。  $last \space updated:2023.3.31$ 有些建模的题只写上来了几道，还会继续更，很多模型还没写上去。qwq  最大流朴素建模 P3376 【模板】网络最大流  模板题，按照题目输入连边跑最大流即可。  P2936 [USACO09J">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://m1nilong.github.io/img/n6j20hbz.png">
<meta property="og:image" content="http://m1nilong.github.io/img/lrtxla81.png">
<meta property="og:image" content="http://m1nilong.github.io/img/b4fje2re.png">
<meta property="og:image" content="http://m1nilong.github.io/img/sbcz78o2.png">
<meta property="og:image" content="http://m1nilong.github.io/img/29roncsj.png">
<meta property="og:image" content="http://m1nilong.github.io/img/j5p3k7bg.png">
<meta property="og:image" content="http://m1nilong.github.io/img/lext9cbs.png">
<meta property="og:image" content="http://m1nilong.github.io/img/13idm1jx.png">
<meta property="og:image" content="http://m1nilong.github.io/img/zbwoc8pb.png">
<meta property="article:published_time" content="2024-09-27T07:13:11.736Z">
<meta property="article:modified_time" content="2024-09-27T07:05:20.522Z">
<meta property="article:author" content="MiniLong">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://m1nilong.github.io/img/n6j20hbz.png">


<link rel="canonical" href="http://m1nilong.github.io/2024/09/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%B5%85%E8%B0%88%E7%BD%91%E7%BB%9C%E6%B5%81%E5%BB%BA%E6%A8%A1/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://m1nilong.github.io/2024/09/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%B5%85%E8%B0%88%E7%BD%91%E7%BB%9C%E6%B5%81%E5%BB%BA%E6%A8%A1/","path":"2024/09/27/【学习笔记】浅谈网络流建模/","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title> | minilong's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">minilong's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E6%B5%81"><span class="nav-number">1.</span> <span class="nav-text">最大流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%B4%E7%B4%A0%E5%BB%BA%E6%A8%A1"><span class="nav-number">1.1.</span> <span class="nav-text">朴素建模</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E5%88%86%E5%9B%BE%E5%8C%B9%E9%85%8D"><span class="nav-number">1.2.</span> <span class="nav-text">三分图匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%B1%82%E5%9B%BE"><span class="nav-number">1.3.</span> <span class="nav-text">分层图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE"><span class="nav-number">2.</span> <span class="nav-text">二分图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%B4%E7%B4%A0%E5%BB%BA%E6%A8%A1-1"><span class="nav-number">2.1.</span> <span class="nav-text">朴素建模</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E6%A0%BC%E5%9B%BE%E6%A8%A1%E5%9E%8B"><span class="nav-number">2.2.</span> <span class="nav-text">网格图模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE%E6%9C%80%E5%B0%8F%E7%82%B9%E8%A6%86%E7%9B%96%EF%BC%88Konig-%E5%AE%9A%E7%90%86%EF%BC%89"><span class="nav-number">2.3.</span> <span class="nav-text">二分图最小点覆盖（König 定理）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E5%9B%BE%E6%9C%80%E5%A4%A7%E7%8B%AC%E7%AB%8B%E9%9B%86"><span class="nav-number">2.4.</span> <span class="nav-text">二分图最大独立集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%8B%E7%9B%98%E9%80%89%E7%82%B9%E9%97%AE%E9%A2%98"><span class="nav-number">2.4.1.</span> <span class="nav-text">棋盘选点问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%80%E5%B0%8F%E5%89%B2"><span class="nav-number">3.</span> <span class="nav-text">最小割</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%B4%E7%B4%A0%E5%BB%BA%E6%A8%A1-2"><span class="nav-number">3.1.</span> <span class="nav-text">朴素建模</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E6%A0%BC%E5%9B%BE"><span class="nav-number">3.2.</span> <span class="nav-text">网格图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%BB%84%E9%97%AE%E9%A2%98%EF%BC%88%E4%BA%8C%E9%80%89%E4%B8%80%E9%97%AE%E9%A2%98%EF%BC%8C%E7%9B%B8%E5%90%8C%E5%88%86%E7%BB%84%E8%AE%A1%E7%AE%97%E8%B4%A1%E7%8C%AE%EF%BC%89"><span class="nav-number">3.3.</span> <span class="nav-text">分组问题（二选一问题，相同分组计算贡献）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E6%9D%83%E9%97%AD%E5%90%88%E5%AD%90%E5%9B%BE"><span class="nav-number">3.4.</span> <span class="nav-text">最大权闭合子图</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">MiniLong</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://m1nilong.github.io/2024/09/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%B5%85%E8%B0%88%E7%BD%91%E7%BB%9C%E6%B5%81%E5%BB%BA%E6%A8%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="MiniLong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="minilong's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content=" | minilong's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2024-09-27 15:13:11 / 修改时间：15:05:20" itemprop="dateCreated datePublished" datetime="2024-09-27T15:13:11+08:00">2024-09-27</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>9.4k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>17 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>网络流，网络建模最毒瘤。</p>
<p>本篇学习笔记为本人学习网络流建模的一些基本模型，也作为当前常见网络流建模的一个汇总。</p>
<p>只写了一点，可能有时间再补。</p>
<hr>
<p>$last \space updated:2023.3.31$</p>
<p>有些建模的题只写上来了几道，还会继续更，很多模型还没写上去。qwq</p>
<hr>
<h2 id="最大流"><a href="#最大流" class="headerlink" title="最大流"></a>最大流</h2><h3 id="朴素建模"><a href="#朴素建模" class="headerlink" title="朴素建模"></a>朴素建模</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3376">P3376 【模板】网络最大流</a></li>
</ul>
<p>模板题，按照题目输入连边跑最大流即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2936">P2936 [USACO09JAN]Total Flow S</a></li>
</ul>
<p>依照题意输入连边跑最大流即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1343">P1343 地震逃生</a></li>
</ul>
<p>按照题意连 $a \to b$，容量为 $c$ 的边，跑一次最大流，记录流量 $Flow$。</p>
<p>若 $Flow &#x3D; 0$，无解。否则输出答案 $\left\lfloor \dfrac{x-1}{Flow}\right\rfloor + 1$。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2740">P2740 [USACO4.2]草地排水Drainage Ditches</a></li>
</ul>
<p>模板题，源点 $1$，汇点 $n$，按照题目输入连边跑最大流即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3701">P3701 主主树</a></li>
</ul>
<p>按照题意将 bxy 阵营中每个人向对方阵营中可以击败的人连容量 $1$ 的边，$s$ 向 bxy 阵营中每个人连容量为每个人的生命，对方阵营中每个人向 $t$ 同样连他们生命为容量的边。并且，统计每个阵营中 YYY 的数量，将每个阵营中的 J 的生命加上他所在阵营中的 YYY 数量即可。<strong>注意：YYY 给 J 加生命，并不需要浪费 YYY 的生命，所以直接加上即可，不需要连边</strong>。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2472">P2472 [SCOI2007] 蜥蜴</a></li>
</ul>
<p>简单拆点题。因为每个石柱只能条 $h_{i,j}$ 次，所以要将每个点进行<strong>拆点</strong>。具体来讲，将每个点 $(i,j)$ 拆成 $(i,j),(i,j)’$ 两点，且连边 $(i,j) \to (i,j)’$，容量为 $h_{i,j}$。（ps：每个二维点 $(i,j)$ 可以转化为一维的编号 $(i-1) \times m + j$，$m$ 为最大的第二维度的编号。并且，可以将 $(i,j)’$ 的编号设为 $(i,j) + n \times m$，这样就好处理一点）。再将图中任意两个距离 $\le d$ 的点 $(x,y)$ 和 $(x’,y’)$ 连 $(x,y)’ \to (x’,y’)$，容量 $inf$。（就是拆点情况下一个点的出点连向另一点的入点） 。源点 $s$ 向每个蜥蜴点连容量为 $1$ 的点，每个能直接跳出边缘的点连向汇点 $t$ 容量 $inf$。</p>
<h3 id="三分图匹配"><a href="#三分图匹配" class="headerlink" title="三分图匹配"></a>三分图匹配</h3><p>想了想，还是将这个专题放在最大流中，毕竟还是和二分图有点不同之处的。</p>
<p>首先，三分图的定义还是与二分图类似，将所有的点分成三部分，点集 $A,B,C$。其中，$A,B$ 和 $B,C$ 之间有连边且只有它们间有连边。问这 $3$ 个点集最大匹配是多少。</p>
<p>传统的匈牙利匹配还是可行的，但极力不推荐。因为三分图的点数更多了，而匈牙利复杂度是 $O(nm)$ 的，dinic 的复杂度是 $O(m \sqrt{n})$ 的。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1402">P1402 酒店之王</a></li>
</ul>
<p>模板的三分图匹配，但因为每个房间和菜只能选 $1$ 次，所以要对于每个点进行<strong>拆点</strong>处理，将每个人作为中间点集 $B$，将每个房间向所有喜欢它的人连边，每个人再向所有他喜欢的菜连边（房间和菜都是要拆点的）。源点 $s$ 连向所有房间，再将所有菜连向汇点 $t$。本题涉及的所有边权都是 $1$。（因为都只能选 $1$ 次呀）</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1231">P1231 教辅的组成</a></li>
</ul>
<p>也是和上题类似，三分图匹配的板子。将每本书作为中间点集，答案和练习册作为剩下的两个点集，还是要拆点（只能匹配 $1$ 个）处理，一样地跑最大流就行。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2891">P2891 [USACO07OPEN]Dining G</a></li>
</ul>
<p>完全相同的三分图模板，正常跑即可，和上面两题没有什么本质上的区别。注意，还是要拆点的。</p>
<h3 id="分层图"><a href="#分层图" class="headerlink" title="分层图"></a>分层图</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2754">P2754 [CTSC1999]家园 &#x2F; 星际转移问题</a></li>
</ul>
<p>考虑到对于每个飞船的周期行驶和太空站的停留很难处理，所以可以使用<strong>分层图</strong>来解决这些问题。首先，可以将原图按时间分层，每层都有 $n$ 个节点表示这个时间点的 $n$ 个星球情况。当可以表示时间这个维度时，周期也很好处理了。对于每个飞船，将它从上一层停留的节点 连向 按周期行走时到这一层停留的节点。也就是 $u_{cur-1} \to v_{cur}$（$u,v$ 是它运行周期中相邻的两个节点），容量为 $h_i$<br>。同时，因为人可以在每个节点上停留，所以可以对于每个 $u$ 连 $u_{cur-1} \to u_{cur}$，容量为 $inf$。</p>
<p>连接 $s \to earth$，容量为 $k$。 </p>
<p>然后有两种方法：</p>
<ol>
<li>二分</li>
</ol>
<p>显然可以二分答案，处理这个时间。</p>
<p>每次重新按上面建图，$s$ 在第一层连接到 $earth$，容量 $k$。在 $mid$ 层的 $moon_{mid}$ 连到 $t$，容量也是 $k$。然后跑最大流，如果结果等于 $k$ 的话，那么就说明这个答案符合要求。</p>
<ol start="2">
<li>累加最大流</li>
</ol>
<p>可以每层都跑一次最大流，<strong>只在上一层跑完的残量网络上跑，不能重新建图</strong>。</p>
<p>枚举每个时间，每层从上一层连完后再将每一层的 $moon_i \to t$，容量 $inf$。<strong>注意：每一层的月球节点都要向汇点连边，而源点只能在第一层向地球节点连容量 $k$ 的边</strong>。 因为人是可以在地球上停留的，也最多只能给 $k$ 的流量，不能给多。同理，月球也是可以从上一层继承的，但是不明确最后的节点在哪（因为是枚举时间的），所以每层都要连一遍。</p>
<p>当累加到 $k$ 时，那么当前的时间 $cur$ 就是答案。</p>
<p>如何处理无解？</p>
<p>可以使用并查集维护一下连通性（最严谨的），也可以二分时没答案就是无解，或者枚举时间时找个极大值，如果超过它还没解，就是无解。</p>
<h2 id="二分图"><a href="#二分图" class="headerlink" title="二分图"></a>二分图</h2><p>最大流跑二分图匹配时，建立超级源点 $s$ 连接每个左边的节点，将每个右边的节点连到超级汇点 $t$。如下图。</p>
<p><img src="/./img/n6j20hbz.png"></p>
<h3 id="朴素建模-1"><a href="#朴素建模-1" class="headerlink" title="朴素建模"></a>朴素建模</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2763">P2763 试题库问题</a></li>
</ul>
<p>将每个试题 $i$ 作为左边节点，每种类型 $p_i$ 作为右边节点。</p>
<p>$s$ 向每个试题连一条容量 $1$ 的边，每种类型向 $t$ 连容量为需求量的边。</p>
<p>每个试题 $i$ 向每个它可以属于的类型 $p_{i,j}$ 连容量为 $1$ 的边。</p>
<p>输出方案时在 残量网络 中寻找 与每个类型连边且不是汇点的 有流量经过 的边，输出那个节点即可。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[u]; i; i = e[i].nxt)&#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].v;</span><br><span class="line">        <span class="keyword">if</span>(e[i].w &amp;&amp; v &lt;= n)&#123;<span class="comment">//e[i].w 为正表示残量网络中有流量</span></span><br><span class="line">        <span class="comment">//v &lt;= n 是表示边连的是题目的节点而不是汇点。</span></span><br><span class="line">            <span class="built_in">write</span>(v), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="网格图模型"><a href="#网格图模型" class="headerlink" title="网格图模型"></a>网格图模型</h3><p>网格图是天然的二分图，它既可以将所有行和列分成两边的节点，相互连边表示一个点，还可以黑白染色等处理，让其变成一个二分图。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1129">P1129 [ZJOI2007] 矩阵游戏</a></li>
</ul>
<p>观察题目，手玩一下样例可以发现一个性质：对于任意的行或列，无论进行多少次操作，它的黑点个数都是不变的。</p>
<p>因为对于一个行，和其他行交换明显不会改变它任何状态，交换列也只是将它上面的黑点的位置改变，数量也是不变的。同理，列也是如此。</p>
<p>所以可以考虑把每行当成左边的点，每列当成右边的点，每个黑点 $(x,y)$ 连 $row(x) \to col(y)$，然后跑最大匹配即可。</p>
<p>如果匹配数为 $n$ 就是有解，否则无解。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2825">P2825 [HEOI2016&#x2F;TJOI2016]游戏</a></li>
</ul>
<p>网格图，很快就可以得结论。如果没有 <code>#</code> 的限制就类似八皇后问题。因为每行和每列都只能有一个点，所以可以将行和列组成一个二分图，可以放的地方连边 $row(x) \to col(y)$，最大匹配。但是有了 <code>#</code> 的限制，如何解决？</p>
<p>可以将每一行和每一列分别分成由 <code>#</code> 隔开的几块，将它们分别编号，如样例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#***</span><br><span class="line">*#**</span><br><span class="line">**#*</span><br><span class="line">xxx#</span><br></pre></td></tr></table></figure>

<p>将其行列编号：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id：行  id：列</span><br><span class="line">#111	#246</span><br><span class="line">2#33	1#46</span><br><span class="line">44#5	13#6</span><br><span class="line">666#	135#</span><br></pre></td></tr></table></figure>

<p>可以观察到，每一行（或列）当它前面一个字符为 <code>#</code> 时，将其编号加一，也可以理解为每一个 <code>#</code> 往后就是新的一行（或列）。这样就可以解决 <code>#</code> 隔开的问题了。</p>
<p>然后按上述连边跑最大匹配即可。</p>
<h3 id="二分图最小点覆盖（Konig-定理）"><a href="#二分图最小点覆盖（Konig-定理）" class="headerlink" title="二分图最小点覆盖（König 定理）"></a>二分图最小点覆盖（König 定理）</h3><p>结论：<strong>二分图最小点覆盖&#x3D;最大匹配&#x3D;最大流</strong></p>
<p>证明：</p>
<p>在证明这个结论前，先来看几条关于二分图匹配的性质：</p>
<p>令左边点集 $A$，右边点集 $B$，已匹配的点集为 $P$，匹配的边集为 $E$。</p>
<p>设 $u \in A,v \in B$，且 $u,v$ 间有连边</p>
<ul>
<li><p>若 $u \notin P$，则必定存在 $v \in P$。因为若 $u,v$ 都没匹配，但它们之间有连边，它们之间必定可以匹配， 所以不可能存在 $u,v \notin P$ 的情况。</p>
</li>
<li><p>若 $u,u’,v,v’ \in P; u \to v \in E; u’ \to v’ \in E$，则肯定不存在 $u &#x3D; u’,u&#x3D;v’,v&#x3D;u’,v&#x3D;v’$ 这些情况。因为 $1$ 个点能且仅能匹配 $1$ 个点。</p>
</li>
<li><p>若 $u \in P$，则至少存在 $1$ 个 $v \in to(u),v\in P$，且必定存在且仅存在 $1$ 个 $v$，是直接与 $u$ 相匹配的。因为若没有任何与 $u$ 相连且匹配的点，$u$ 就不可能被匹配。</p>
</li>
</ul>
<p>有了这些性质，就比较好证明了。</p>
<ol>
<li>$P$ 覆盖了所有边</li>
</ol>
<p>证明：假设存在一条边 $e \notin E$ 没被覆盖，也就是它的两边的节点 $u,v$ 均没被匹配（$u,v \notin P$），则与性质 $1$ 矛盾。所以所有边中都至少有 $1$ 个节点被匹配到。</p>
<ol start="2">
<li>$|E| \le $ 最小点覆盖数</li>
</ol>
<p>证明：由性质 $3$ 得，$u$ 至少存在 $1$ 个与之匹配的 $v$，则对于边 $u \to v \in E$， 必定存在 $u$ 或 $v$ 来覆盖这个边。又因性质 $2$，对于每个匹配边 $u \to v$ 都与其他匹配边 $u’ \to v’$ 不存在交点。则每个匹配边都需要至少 $1$ 个节点覆盖。所以必定覆盖点数是大于或等于匹配边的数量的。（不然匹配边都没法被覆盖了）</p>
<ol start="3">
<li>构造匹配</li>
</ol>
<p>从 $A$ 集的未匹配点 $u(u \notin P)$ 出发，走未匹配的边。由性质 $1$ 可得，必定能走到一个 $v \in P$，再从 $v$ 走匹配的边到 $u’ \in P$，又从 $u’$ 走没匹配的边至 $v’$。以此类推，最后由匹配边结束（有最大匹配）。那么，可以构造所有 $u \in A$ 且 $u$ 没被遍历与所有 $v \in B$ 且 $v$ 被遍历过了。这些点数必然是等于 $|E|$ 的，且根据刚刚的遍历顺序，这些点又必然覆盖了所有边。（可由定理 $1$ 推导）</p>
<p>因为二分图最小覆盖点数是 $\ge |E|$ 的（定理 $2$），且能构造出一种点数为 $|E|$ 的点将所有边覆盖。所以，最小覆盖点数肯定是等于 $|E|$ 的，也就是最大匹配数。</p>
<p>证毕。</p>
<h3 id="二分图最大独立集"><a href="#二分图最大独立集" class="headerlink" title="二分图最大独立集"></a>二分图最大独立集</h3><p>在二分图最小点覆盖中，每条边都至少有 $1$ 个点被选。那么对于所有没有被选的点，不可能在 $1$ 条边上出现多于 $1$ 个（因为如果这条边上两个点都没被选，那这条边也不会被覆盖了），所以可以保证没被选的点集是独立的。然而又因为没有更小的点覆盖了，所以最大的独立集也只能是最小点覆盖集的补集（没被选的点），也就是 $n - |E|$。</p>
<h4 id="棋盘选点问题"><a href="#棋盘选点问题" class="headerlink" title="棋盘选点问题"></a>棋盘选点问题</h4><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4304">P4304 [TJOI2013]攻击装置</a></li>
</ul>
<p>从矩阵上一点出发黑白染色，将它能攻击到的地方染成与它相反的颜色。则可以将原图分为两个点集（黑色与白色的）</p>
<p><img src="/./img/lrtxla81.png"></p>
<p>如上图，则可以构造一个二分图，将所有黑色的点与所有它能访问到的白色的节点，且能放装置的点连边。然后求最大独立集（要求不能互相攻击）即可。</p>
<p>具体来讲，黑色的点是 $x + y \equiv 0 \pmod{2}$的点，白色的点是 $x +y \equiv 1 \pmod{2}$ 的点。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3355">P3355 骑士共存问题</a></li>
</ul>
<p>与 <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4304">P4304 [TJOI2013]攻击装置</a> 完全相同，按照 P4304 的建图方式跑即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5030">P5030 长脖子鹿放置</a></li>
</ul>
<p>与前两题类似，可以先将每个点能攻击到的点黑白染色，可以发现如下规律：</p>
<p><img src="/./img/b4fje2re.png"></p>
<p>则可以将所有黑色的点连向<strong>所有能放置的且能攻击到的</strong>白色节点。</p>
<p>黑色的节点是行数为奇数的点，白色的为行数为偶数的点。连边跑二分图最大独立集即可。</p>
<h2 id="最小割"><a href="#最小割" class="headerlink" title="最小割"></a>最小割</h2><p>最小割是指将原图划分为两个集合 $S$ 和 $T$，其中 $s \in S, t\in T$，最小的 $\sum\limits_{u\in S, v \in T} w(u,v)$， $w(u,v)$ 为 $u \to v$ 边的边权。</p>
<p><strong>定理</strong>：最大流&#x3D;最小割（仅在数值上相同）</p>
<h3 id="朴素建模-2"><a href="#朴素建模-2" class="headerlink" title="朴素建模"></a>朴素建模</h3><p>题目描述将图的节点分为两部分，求最小割时，使用朴素建模。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3931">P3931 SAC E#1 - 一道难题 Tree</a></li>
</ul>
<p>让根节点与所有叶子节点不连通，显然最小割，将所有叶子节点连到汇点 $t$，源点 $s$ 为根节点，从根开始往下遍历，在原图的边中，使深度小的点连到深度大的点，最后跑一边最小割即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1345">P1345 [USACO5.4]奶牛的电信Telecowmunication</a></li>
</ul>
<p>由题意得，$c1,c2$ 分别是源点和汇点。因为是要求最小的断开电脑数量，所以不能在边上体现，要将每个电脑 $i$ 拆点为 $i, i+n$，使 $i \to i + n$ 边权为 $1$。（$s,t$ 的边权为 $inf$，因为它们不能被销毁。）然后连双向边 $u \to v, v \to u$ 都为 $inf$（题目中说的是双向联通），跑最小割即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2598">P2598 [ZJOI2009]狼和羊的故事</a></li>
</ul>
<p>题目让我们求将狼和羊分开的最小篱笆个数，也就是最小割。</p>
<p>那么两个格子之间如何连边呢？因为要将羊和狼的格子隔开，所以可以将所有 羊 的节点向周围所有 不是羊 的节点连边权为 $1$ 的边。又因为有空地的存在，可以在另一方面阻挡羊和狼，所以可以将每个空地周围所有不是羊的节点和它们连边（因为是羊的刚刚连过了）。最后套路将 $s$ 连向所有羊，所有狼连向 $t$，边权均为 $inf$。最小割就是答案。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1344">P1344 [USACO4.4] 追查坏牛奶 Pollutant Control</a></li>
</ul>
<p>题目乍一看，像是一个最小割模板。第一问就直接求最小割即可，关键在于第二问的最少停止的卡车数量。第二问实质上就是求<strong>所有的最小割中 最少割掉的 边数量</strong>，所以可以考虑将边权都赋为 $1$ 再求一遍最小割。但是有问题，新的最小割的这些边放到原图中不一定是原图的最小割。所以，只能取第一问最小割中流量流过的边，也就是残量网络中有流量的边，将它们在新图中的边权赋为 $1$，原图的其他边边权都赋为 $inf$，这样就能保证以边权最小割为前提下的最少数量了。</p>
<h3 id="网格图"><a href="#网格图" class="headerlink" title="网格图"></a>网格图</h3><ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2774">P2774 方格取数问题</a></li>
</ul>
<p>给定一个网格图，让你求最大权值的点集使它们没有公共边。</p>
<p>很显然，当选择一个点后，它所有邻点都不能选了。所以可以对网格图黑白染色，将它的点集分为两个，黑色的和白色的。此时，选择一个黑色的点就不能选它周围的所有白色点，选白色的同理。所以，可以建立一个二分图，左边为黑点，右边为白点，将黑点和所有<strong>相邻的白点</strong>连边，容量为 $inf$ （为什么？）。然后 $s \to black_{i,j}$，容量 $a_{i,j}$，$white_{i,j} \to t$，容量 $a_{i,j}$。令 $sum &#x3D; \sum{a_{i,j}}$，$sum - mincut$ 就是答案。</p>
<p>简单证明一下。对于一个黑点 $black_{i,j}$，设它周围的几个点为 $white_{i-1,j},white_{i,j-1},white_{i,j+1},white_{i+1,j}$。因为它们之间的连边为 $inf$，所以不可能成为 $cut$，所以黑点和它周围的 $4$ 个白点是必然联通的。</p>
<p>若割掉 $black_{i,j}$，那么周围的 $white_{i-1,j},white_{i,j-1},white_{i,j+1},white_{i+1,j}$ 就不会与 $s$ 联通，<strong>剩下的</strong>贡献是这 $4$ 个白点。</p>
<p>若割掉 $white_{i-1,j},white_{i,j-1},white_{i,j+1},white_{i+1,j}$，那么<strong>剩下的</strong>贡献就是 $black_{i,j}$ 的权值，也不会与 $t$ 联通了。</p>
<p>对于所有这样的一组点，割断的方式必定是两种中的一种，所以肯定能使它们在原网格图中不连通。</p>
<p>又因为最小割是上述两种<strong>割掉的</strong>权值中的最小值，所以用所有节点的权值和减去它，剩下的必定是最大的。</p>
<h3 id="分组问题（二选一问题，相同分组计算贡献）"><a href="#分组问题（二选一问题，相同分组计算贡献）" class="headerlink" title="分组问题（二选一问题，相同分组计算贡献）"></a>分组问题（二选一问题，相同分组计算贡献）</h3><p>分组问题、二选一问题，便是要将每个物品分到两个集合 $A,B$ 中，分到集合 $A$ 的花费（或收入）是 $a_i$，放到集合 $B$ 的花费（或收入）为 $b_i$。</p>
<p>对于建模，可以将每个物品 $i$，连 $s \to i$，表示分到 $A$ 集合，边权为 $a_i$。连 $i \to t$，表示分到 $B$ 集合，边权为 $b_i$。此时最小割就是分组的最小花费了（同理，所有边权之和 $sum$ 减去最小割就是最大收入 $sum - mincut$），因为每个节点都连到 $s$ 或 $t$，要想让它们不连通，只能断掉到 $s $ 或到 $t$ 的边了，也就是选——最小花费（或不选——最大贡献）哪一条边。</p>
<p>关于这类问题，往往会有一些附加条件。最常见的便是对于几个物品 $p_1,p_2 \dots p_m$，<strong>全都</strong>在相同的分组（集合）中会有额外的贡献，求最大的总贡献。例如这 $m$ 个物品都在 $A$ 集合时的贡献为 $c_1$，都在 $B$ 集合时有贡献 $c_2$。考虑在连边中表现出这个贡献。如果都在集合 $A$，便可以设立虚点 $x$，使得 $s \to x$，容量为 $c_1$， $x \to p_1,p_2 \dots p_m$ 连 $m$ 条边，容量都是 $inf$。此时最小割就是答案，为什么？</p>
<p><img src="/./img/sbcz78o2.png"></p>
<p>考虑上图，若 $1$ 在集合 $A$， $2$ 在集合 $B$，那么会怎样？（不考虑 $3$ 节点）</p>
<p><img src="/./img/29roncsj.png"></p>
<p>那么，在这种情况下， $s$ 到 $t$ 还是联通的，因为有这个虚点 $x$ 的存在。</p>
<p>又因为 $x \to 2$ 边权为 $inf$，所以 $c1$ 这个贡献肯定是被割掉了。</p>
<p>同理，当 $1,2$ 没有同时属于集合 $A$ 时，$c1$ 都会被割掉。</p>
<p>所以，只有在 $1,2$ 共同属于 $A$ 时，$c1$ 才不会被割掉，会加到 $sum$ 中不会被减去。（因为收入&#x3D; $sum - mincut$）</p>
<p>那么，同理，$c_2$ 也是类似的连边。</p>
<p><img src="/./img/j5p3k7bg.png"></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1361">P1361 小M的作物</a></li>
</ul>
<p>模板题，直接套用刚刚的模型 $s \to i$ 表示 $i$ 在 $A$ 种植， $i \to t$ 表示在 $B$ 种植，对于每种组合按上述方法建立虚点，跑最小割即可。</p>
<p>答案就是 $sum - mincut$（最大收益）。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2057">P2057 [SHOI2007] 善意的投票 &#x2F; [JLOI2010] 冠军调查</a></li>
</ul>
<p>类似的二选一问题，但是将贡献从 $p_1,p_2$ 在相同集合中会有收益变为了它们不在同一集合时有花费，如何解决？</p>
<p>假如说没有好朋友的限制，就直接将每个小朋友依照意愿向 $s$ 或 $t$ 连边即可。</p>
<p>有了好朋友的限制，可以将每对好朋友 $u,v$ 连 $u \to v$，$v \to u$ 的边，表示它们在相同立场（双向边是因为朋友关系是对称的，a 是 b 的朋友，b 也是 a 的朋友），最小割就是答案。</p>
<p>证明：若割掉了朋友之间的连边，相当于多一个朋友之间冲突的花费，对于他们的本身意愿没有影响。若割掉两人其中一个向源或汇点连的边，相当于舍弃自身意愿，满足好朋友，就是与本身意愿冲突的花费。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1646">P1646 [国家集训队]happiness</a></li>
</ul>
<p>模板，套用上述模型。每个点连到文科（$s$）和理科（$t$），再相邻每两个人之间建立两个虚点表示同选文科或理科即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4313">P4313 文理分科</a></li>
</ul>
<p>同上题，只是将相邻两个人分组相同的贡献改成周围的人都与其相同的贡献，套模型即可。</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1935">P1935 [国家集训队]圈地计划</a></li>
</ul>
<p>也是一道经典的分组问题。但这题的变化之处在于<strong>不同</strong>分组有贡献。</p>
<p>但是，不同分组的正贡献是无法用这个模型来表示出来的，所以要考虑转换思路，如何将<strong>不同分组</strong>转换为<strong>相同分组</strong>。</p>
<p>可以将原网格图进行黑白染色，任意相邻两格黑白颜色均不同，那显然可以将原图分为两种节点（注意：这里不是二分图，只是点类型不同）黑或白。将黑色或白色节点的权值倒置（将原来分到 $A$ 集合的权值 $a_i$ 分到集合 $B$，原来分到 $B$ 集合的 $b_i$ 分到集合 $A$），这样做<strong>并不会对每个点自身的取值有任何影响</strong>，因为选两集合中的一个都是对称的，没有本质上的不同。而且，这样做完美地将<strong>不同集合</strong>转化成了同一集合（因为将其中一种颜色的所有点权值倒置了），就能直接套用模型了。</p>
<p>具体来讲，将 $(x + y) \equiv 1 \pmod 2$ 的节点的 $a_i$ 与 $b_i$ 交换。然后相邻两节点同上建立两个虚点，分别向 $s$ 和 $t$ 都连 $c_{i,j} + c_{newi,newj}$（因为选集合就行了，不论都选哪个集合都是等价的）。然后用所有权值和减去最小割即可。 </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4210">P4210 土地划分</a></li>
</ul>
<p>一道好题，主要难点就是求<strong>不同分组的负贡献</strong>。如果先不考虑两个节点不同集合带来的负贡献的话，那么就是分组问题的模板。对于两个相同集合的点，建立虚点 $x’$，使得 $s \to x’$ 边权 $EA$，然后 $x’ \to u$，$x’ \to v$ 边权 $inf$，连到 $t$ 同理。然后考虑将这个负贡献加进来，因为不能直接表现，所以要将其转化为相同分组的贡献。因为最后的答案是 $sum - mincut$，所以可以想到<strong>在这个最小割中将贡献转为正，然后在权值和中不加上它，最后的贡献就是负的了</strong>（相当于 $sum - (mincut + EC)&#x3D;sum - mincut - EC$）。有了这个思路，那么接下来的就很好理解了。将 $s \to x’$，$y’ \to t$ 中的边权都加上 $EC$，然后在 $sum$ 中加上<strong>一个</strong> $EC$。此时，若这两个节点在同一集合，那么 $mincut$ 中会有一个 $EC$，$sum$ 中多加的一个 $EC$ 和它正好抵消了。若它们不在同一集合，那么 $mincut$ 中会有两个 $EC$，此时的贡献正好多了个 $-EC$，巧妙地将它的负贡献表示出来了。</p>
<p>具体实现可以见 <a target="_blank" rel="noopener" href="https://minilong.blog.luogu.org/solution-p4210">link</a>。</p>
<h3 id="最大权闭合子图"><a href="#最大权闭合子图" class="headerlink" title="最大权闭合子图"></a>最大权闭合子图</h3><p>最大权闭合子图，指在一张有向图 $G$ 中选择一张子图 $G’$，使得 $\forall u \in G’, to(v) \in G’$，$to(u)$ 指 $u$ 在原图中的后继，求最大 $G’$ 权值和。文字化来讲，就是选出一些节点，让它们的后继都被选，也就是选了一个节点 $u$ 就必须选所有他的后继 $v \in to(u)$，你要让这些选出来节点的和最大（每个节点的权值<strong>可以为负数</strong>）。</p>
<p>对于建模，因为不能有负容量的边，所以只能另想办法。</p>
<p>设每个点的点权为 $a_1,a_2 \dots a_n$。</p>
<p>若 $a_i &gt; 0$，则 $s \to i$，权值为 $a_i$。</p>
<p>若 $a_i \le 0$，则 $i \to t$，权值为 $-a_i$。</p>
<p>然后将原图中所有 $u \to v$ 的边权设为 $inf$。</p>
<p>所有正权值之和 $sum$ 减去最小割 $mincut$ 即是答案。为什么？</p>
<p><img src="/./img/lext9cbs.png" alt="原图"></p>
<p><img src="/./img/13idm1jx.png"></p>
<p>此时，因为原图中的每条边边权都为 $inf$，所以最小割不可能割到它，后继全取到的条件满足了。</p>
<p>再考虑断边的情况。</p>
<p>若不取一个正权值点，例如上图的 $s \to 10$ 的边断开后就不会通过这个点联通，那么 $sum$ 中原本的 $10$ 也会被减去，所以不会影响。</p>
<p>若取了一个正权值点，例如上图的 $s \to 10$ 的边联通，那么这时 $s$ 到 $t$ 还是联通的，要考虑继续割边。又因为原图中所有的边都不会被断开，所以能断开的就是这个点能走到的所有负权值点与 $t$ 的边，在上图的例子中就会割掉 $-5 \to t,-3 \to t, -2 \to t$ 三条边，如下图。</p>
<p><img src="/./img/zbwoc8pb.png"></p>
<p>这时，断掉的边 $mincut &#x3D; 5+2+3$ 正好对应 $-5,-2,-3$ 权值和的相反数。那么用 $sum - mincut$，那么它的贡献正好又变成负的了，完美地解决了正负性的问题。 </p>
<p>所以，选出来和的最大值就是 $sum - mincut$（使割掉的正权值 和割掉的负权值和的相反数 最小）</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/09/27/%E3%80%90%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E3%80%91%E6%B5%85%E8%B0%88%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84SA/" rel="prev" title="">
                  <i class="fa fa-angle-left"></i> 
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/09/27/%E5%A5%BD%E9%A2%98%E5%88%86%E4%BA%AB%20II/" rel="next" title="">
                   <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">MiniLong</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">150k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">4:33</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/m1nilong" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  <script src="/js/third-party/pace.js"></script>


  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
